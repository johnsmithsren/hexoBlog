---
layout: post
title: 网络配置与路由基础
date: 2024-12-27 17:14:19
tags:
  - 路由配置
categories:
  - 网络技术
---

# 网络配置与路由基础

## 1. IP地址基础

### 1.1 IP地址的组成
- IP地址由32位二进制数组成（IPv4）
- 通常以点分十进制表示：如 192.168.1.1
- 分为网络部分和主机部分
- IPv4地址分为A、B、C、D、E五类

### 1.2 网络位与主机位
#### 网络位（Network Portion）
- **定义**：IP地址中用于标识网络的位
- **作用**：
  - 标识IP所属的网络
  - 用于路由选择
  - 决定网络的规模
- **特点**：
  - 同一网络中的所有主机，网络位相同
  - 由子网掩码中的"1"对应的位确定
  - 网络位越多，可划分的子网越多

#### 主机位（Host Portion）
- **定义**：IP地址中用于标识主机的位
- **作用**：
  - 标识网络内的具体主机
  - 决定网络可容纳的主机数量
- **特点**：
  - 同一网络中的主机，主机位必须唯一
  - 由子网掩码中的"0"对应的位确定
  - 主机位越多，可用主机数越多
  - 全0表示网络地址，全1表示广播地址

#### 实例说明
```
IP地址：192.168.1.1
子网掩码：255.255.255.0

二进制形式：
IP：    11000000.10101000.00000001.00000001
掩码：  11111111.11111111.11111111.00000000
网络位：11000000.10101000.00000001.
主机位：                            00000001

- 网络地址：192.168.1.0（主机位全0）
- 广播地址：192.168.1.255（主机位全1）
- 可用主机范围：192.168.1.1 - 192.168.1.254
```

### 1.3 IP地址分类
| 类别 | 首位范围 | 网络部分 | 主机部分 | 默认子网掩码 | 最大网络数 | 每个网络最大主机数 |
|-----|---------|---------|---------|------------|-----------|-----------------|
| A类 | 0-127   | 8位     | 24位    | 255.0.0.0  | 126       | 16,777,214     |
| B类 | 128-191 | 16位    | 16位    | 255.255.0.0| 16,384    | 65,534         |
| C类 | 192-223 | 24位    | 8位     | 255.255.255.0| 2,097,152| 254           |

### 1.4 特殊IP地址
- **127.0.0.1**: 本地回环地址
- **0.0.0.0**: 表示本网络
- **255.255.255.255**: 广播地址

## 2. 子网掩码详解

### 2.1 子网掩码的作用
- 用于区分IP地址中的网络部分和主机部分
- 确定IP地址所属的网络范围
- 判断两个IP是否在同一网段

### 2.2 子网掩码计算
```
示例：
IP地址：192.168.1.1
子网掩码：255.255.255.0

二进制形式：
IP：  11000000.10101000.00000001.00000001
掩码：11111111.11111111.11111111.00000000
```

### 2.3 子网划分
- **CIDR表示法**：192.168.1.0/24
- 可用主机数 = 2^主机位数 - 2
- 网络数 = 2^网络位数
- 同一网段的计算机可以互通
- 网络位越多，可划分的子网越多

## 3. 路由配置基础

### 3.1 路由表组成
- 目标网络
- 子网掩码
- 下一跳地址
- 接口
- 度量值（跳数）

### 3.2 路由类型
1. **直连路由**
   - 直接连接到路由器接口的网络
   - 自动添加到路由表

2. **静态路由**
   - 手动配置的路由条目
   - 适用于简单网络
   ```
   基本格式：
   ip route 目标网络 子网掩码 下一跳地址
   ```

3. **动态路由**
   - 通过路由协议自动学习
   - 常见协议：RIP、OSPF、BGP

### 3.3 路由优先级
1. 直连路由 > 静态路由 > 动态路由
2. 最长匹配原则
3. 管理距离值越小优先级越高

## 4. 常见网络命令

### 4.1 Windows系统
```bash
# 查看IP配置
ipconfig /all

# 查看路由表
route print

# 添加静态路由
route add 目标网络 mask 子网掩码 网关地址

# 删除路由
route delete 目标网络
```

### 4.2 Linux系统
```bash
# 查看IP配置
ifconfig
ip addr show

# 查看路由表
route -n
ip route show

# 添加静态路由
ip route add 目标网络/掩码位数 via 网关地址

# 删除路由
ip route del 目标网络/掩码位数

RouterA(config)# ip route 192.168.2.0 255.255.255.0 192.168.1.2

Switch# configure terminal
Switch(config)# vlan 10
Switch(config-vlan)# name Sales
Switch(config-vlan)# exit

Switch(config)# interface range fa0/1 - 24
Switch(config-if-range)# switchport mode access
Switch(config-if-range)# switchport access vlan 10
Switch(config-if-range)# exit
```